<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>SonarCheck - Results</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
</head>

<body>
    <!-- NAVBAR -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="/" class="brand">
                <i class="fas fa-water"></i> SonarCheck
            </a>
            <ul class="nav-links">
                <li><a href="/">Predict</a></li>
                <li><a href="/about">About</a></li>
            </ul>
        </div>
    </nav>

    <div class="container">
        <a href="/" class="btn btn-secondary mb-4"
            style="text-decoration: none; display: inline-flex; align-items: center; gap: 8px;">
            <i class="fas fa-arrow-left"></i> New Prediction
        </a>

        <!-- RESULT HEADER -->
        <div class="result-header">
            <h1>{{ prediction_text }}</h1>
            <p>Analysis Complete</p>
        </div>

        <!-- MAIN RESULTS GRID -->
        <div class="result-grid">
            <!-- Card 1: Object Type -->
            <div class="card">
                <div class="form-section">
                    <h2>{{ object_char.icon }} Object Type</h2>
                    <div style="margin: 20px 0;">
                        <span class="status-badge {% if object_type == 'Rock' %}rock{% else %}mine{% endif %}">
                            {{ object_type }}
                        </span>
                    </div>
                    <p class="text-muted">{{ object_char.description }}</p>
                    <p
                        style="font-size: 0.9rem; color: var(--text-muted); margin-top: 15px; border-top: 1px solid var(--border); padding-top: 15px;">
                        <strong>Signal Pattern:</strong><br>
                        {{ object_char.typical_signals }}
                    </p>
                </div>
            </div>

            <!-- Card 2: Confidence Level -->
            <div class="card">
                <div class="form-section">
                    <h2><i class="fas fa-chart-pie"></i> Confidence Score</h2>
                    <div class="risk-level" style="color: var(--text-main);">
                        {{ "%.1f"|format(confidence_percent) }}%
                    </div>
                    <div class="confidence-bar">
                        <div class="confidence-fill {% if object_type == 'Rock' %}rock{% else %}mine{% endif %}"
                            style="width: {{ confidence_percent }}%;"></div>
                    </div>
                    <p class="text-muted"><strong>Level:</strong> {{ confidence_level }}</p>
                </div>
            </div>

            <!-- Card 3: Risk Level -->
            <div class="card">
                <div class="form-section">
                    <h2><i class="fas fa-exclamation-triangle"></i> Risk Assessment</h2>
                    <div class="risk-level"
                        style="color: {% if risk_level == 'CRITICAL' or risk_level == 'HIGH' %}var(--danger){% elif risk_level == 'SAFE' or risk_level == 'LIKELY SAFE' %}var(--secondary){% else %}var(--warning){% endif %};">
                        {{ risk_level }}
                    </div>
                    <p class="text-muted">
                        {% if risk_level == 'CRITICAL' %}
                        Critical threat detected. Immediate action required.
                        {% elif risk_level == 'HIGH' %}
                        High probability of mine. Exercise extreme caution.
                        {% elif risk_level == 'MODERATE' %}
                        Potential threat. Further investigation advised.
                        {% elif risk_level == 'LIKELY SAFE' %}
                        Likely natural formation. Proceed with caution.
                        {% else %}
                        Safe natural formation confirmed.
                        {% endif %}
                    </p>
                </div>
            </div>
        </div>

        <!-- RECOMMENDATION -->
        <div class="card"
            style="border-left: 4px solid {% if object_type == 'Rock' %}var(--secondary){% else %}var(--danger){% endif %};">
            <div class="form-section">
                <h2><i class="fas fa-lightbulb"></i> Recommendation</h2>
                <p style="font-size: 1.1rem; font-weight: 500; color: var(--text-main);">
                    {{ recommendation }}
                </p>
            </div>
        </div>

        <!-- PROBABILITY BREAKDOWN -->
        <div class="card">
            <div class="form-section">
                <h2><i class="fas fa-chart-bar"></i> Classification Probabilities</h2>

                <div style="margin-top: 25px;">
                    <!-- Rock Bar -->
                    <div style="display: flex; align-items: center; margin-bottom: 15px;">
                        <div style="width: 80px; font-weight: 600;">Rock</div>
                        <div
                            style="flex: 1; height: 24px; background: var(--bg-input); border-radius: 12px; overflow: hidden; margin: 0 15px;">
                            <div
                                style="width: {{ rock_probability }}%; height: 100%; background: var(--secondary); display: flex; align-items: center; justify-content: flex-end; padding-right: 10px; font-size: 0.8rem; font-weight: bold; color: #000;">
                                {{ "%.1f"|format(rock_probability) }}%
                            </div>
                        </div>
                    </div>

                    <!-- Mine Bar -->
                    <div style="display: flex; align-items: center;">
                        <div style="width: 80px; font-weight: 600;">Mine</div>
                        <div
                            style="flex: 1; height: 24px; background: var(--bg-input); border-radius: 12px; overflow: hidden; margin: 0 15px;">
                            <div
                                style="width: {{ mine_probability }}%; height: 100%; background: var(--danger); display: flex; align-items: center; justify-content: flex-end; padding-right: 10px; font-size: 0.8rem; font-weight: bold; color: #fff;">
                                {{ "%.1f"|format(mine_probability) }}%
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- TOP RISK FACTORS -->
        <div class="card">
            <div class="form-section">
                <h2><i class="fas fa-crosshairs"></i> Top Contributing Frequency Bands</h2>
                <p class="text-muted mb-4">
                    These SONAR frequency bands were most significant in the model's decision.
                </p>

                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px;">
                    {% for factor in risk_factors[:6] %}
                    <div
                        style="background: var(--bg-input); padding: 15px; border-radius: 8px; border: 1px solid var(--border);">
                        <div
                            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                            <strong style="color: var(--primary);">Band {{ factor.frequency_band }}</strong>
                            <span
                                style="font-size: 0.8rem; background: rgba(255,255,255,0.1); padding: 2px 6px; border-radius: 4px;">#{{
                                factor.rank }}</span>
                        </div>
                        <div style="font-size: 0.9rem; color: var(--text-muted);">
                            Importance: {{ "%.4f"|format(factor.importance) }}
                        </div>
                        <div
                            style="height: 4px; background: rgba(255,255,255,0.1); margin-top: 8px; border-radius: 2px;">
                            <div
                                style="width: {{ factor.percentage }}%; height: 100%; background: var(--primary); border-radius: 2px;">
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>

    <!-- FOOTER -->
    <footer class="footer">
        <p><strong>SonarCheck</strong> &copy; 2025</p>
        <p style="font-size: 0.9rem; margin-top: 10px;">
            Powered by Machine Learning | <a href="/about">About Project</a>
        </p>
    </footer>
</body>

</html>